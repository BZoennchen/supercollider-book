(sec-fundamental-waveforms)=
# Fundamental Waveforms

Jean-Baptise Joseph Fourier discovered that every function that is 

1. **piecewise continuous** and
2. **bounded**

can be represented as a Fourier series, see [Spectral Analysis and Synthesis](sec-fourier).
In theory, the Fourier series of many functions consists of infinitely many terms. Still, since our hardware resources are finite, we can only generate an approximation of the real thing.
I call functions with these properties *signals*.

Functions that describe an amplitude $y(t)$ over the time $t$ are audio signals and have these qualities.
The signal might also be periodic, but that is not necessary for the existence of a Fourier series of the signal.

To better understand a signal, it is essential to understand its Fourier series.
In fact, the *stethoscope* displays the frequencies of the functions that are the components of the Fourier series.

For audio synthesis, there are some fundamental oscillators.
Both types of synthesizers, that is, analog as well as digital synthesizers, offer these basic oscillators as a starting point.
Let us try to understand their timbre by looking at their Fourier series.

(sec-sine-wave)=
## The Sine Wave

The sine wave 

```{math}
:label: eq:sine
    y_\text{sine}(t) = A \cdot \sin(2\pi \cdot f \cdot t)
```

is the most pure, most basic, and most simple signal.
It is also the most basic waveform there is.
Its Fourier series is equivalent to Eq. {eq}`eq:sine`. 
It consists of only the fundamental frequency $f$ and is theoretically the basis for all other signals.

```{figure} ../../../figs/sounddesign/sine.png
---
width: 400px
name: fig-sine
---
The sine wave with a frequency and amplitude of 1.
```

However, in practice, one does not model something as complex as noise using a Fourier series consisting of sine waves.
It would be too computationally expensive.
A sine wave can be used to generate a nice bass or to amplify the sound of a drum.

(sec-sawtooth-wave)=
## The Sawtooth Wave

The first more complicated and important waveform I want to discuss is the so-called [sawtooth wave](sec-sawtooth-wave)

```{math}
:label: eq:saw
    y_\text{saw}(t) = A \cdot 2 \left( f \cdot t -  \left \lfloor{ \frac{1}{2} + f \cdot t} \right \rfloor  \right),
```

where $A$ is the amplitude and $f$ is the frequency of the wave.


```{figure} ../../../figs/sounddesign/sawtooth.png
---
width: 400px
name: fig-sawtooth
---
The sawtooth wave with a frequency and amplitude of 1.
```

I generated this plot using ``Python`` but we can do the same in ``sclang``.
However, the $x$-axis will be always the number of the sample.
Let us generate the plot in {numref}`Fig. {number} <fig-sawtooth>` using ``sclang``:

```isc
(
var trifunc = {
    arg t;
    var freq = 1, amp;
    amp = (freq*t - floor(1/2 + (freq*t)));
};

var t = Array.interpolation(100, 0, 1);
var y = t.collect({arg t; trifunc.value(t);});

y.plot();
)
```

To understand the [sawtooth wave](sec-sawtooth-wave) musically, we have to look at its Fourier series:

```{math}
:label: eq:saw:fourier
    y_\text{saw}(t) = A \left( \frac{1}{2} - \frac{1}{\pi} \sum_{k=1}^{\infty} (-1)^k \frac{\sin(2\pi k f t)}{k} \right).
```

We can approximate the series by only summing up the first $n$ terms:

```{math}
:label: eq:saw:fourier:n
    y_{\text{saw},n}(t) = A \left( \frac{1}{2} - \frac{1}{\pi} \sum_{k=1}^{n} (-1)^k \frac{\sin(2\pi k f t)}{k} \right).
```

```{figure} ../../../figs/sounddesign/sawtooth_20.png
---
width: 400px
name: fig-sawtooth-20
---
An approximation for the Fourier series of the sawtooth wave with a frequency and amplitude of 1 using $n=20$.
```

The evaluation of many sine functions is computational more expensive than evaluating Eq. {eq}`eq:saw`.
However, we learn from Eq. {eq}`eq:saw:fourier` that

1. each harmonic of $k \cdot f$ with $k \in \mathbb{N}$ of the fundamental $f$ is present and
2. the amplitude of the harmonic $k$ decrease by $1/k$.

Even if the sawtooth wave does not quite sound like a string instrument, its properties are similar to the audio signal generated by string instruments.
Therefore, the sawtooth wave can be the starting point for modeling the sound of a violin, piano or guitar.

We can compute an approximation of the [sawtooth wave](sec-sawtooth-wave) by the technique of additive synthesis using Eq. {eq}`eq:saw:fourier:n`.

In ``sclang`` we can generate the sound of a [sawtooth wave](sec-sawtooth-wave) using the [UGen](sec-ugens) ``Saw``:

```isc
{Saw.ar(220!2)*0.25}.play;
```

(sec-square-wave)=
## The Square Wave

Another important waveform is the [square wave](sec-square-wave) which is a special case of the pulse wave:

```{math}
:label: eq:square
    y_\text{square}(t) = A \cdot \text{sign}\left( \sin\left( 2\pi \cdot f \cdot t \right) \right)
```

where $\text{sign}(\cdot)$ is defined by

```{math}
:label: eq:sign
    \text{sign}(x) = \begin{cases}
    +1 & \text{ if } x \geq 0\\
    -1 & \text{ else.}
    \end{cases}
```

```{figure} ../../../figs/sounddesign/square.png
---
width: 400px
name: fig-square
---
The square wave with a frequency and amplitude of 1.
```

Let's look at its Fourier series:

```{math}
:label: eq:square:fourier
    y_\text{square}(t) = A \cdot \frac{4}{\pi} \cdot \sum_{k=1}^{\infty} \frac{\sin( 2\pi \left[ 2k-1 \right] \cdot f \cdot t)}{2k - 1}
```

Again we learn from the Fourier series Eq. {eq}`eq:square:fourier` that

1. each odd harmonic $(2k-1)f$ with $k \in \mathbb{N}$ of the fundamental $f$ is present and
2. the amplitude of the harmonic $2k - 1$ decreases with $4/(2k - 1)$

The amplitudes also decrease linearly with increasing frequencies.

```{figure} ../../../figs/sounddesign/square_20.png
---
width: 400px
name: fig-square-20
---
An approximation for the Fourier series of the square wave with a frequency and amplitude of 1 using $n=20$.
```

In ``sclang`` we can generate the sound of a [square wave](sec-square-wave) using the [UGen](sec-ugens) ``Pulse``:

```isc
{Pulse.ar(220!2) * 0.25;}.play;
```

The signal of some wind instruments like the clarinet is similar to square wave.
Their sound only contains odd harmonics.

(sec-triangle-wave)=
## The Triangle Wave

The next important wave is the [triangle wave](sec-triangle-wave):


```{math}
:label: eq:triangle
    y_\text{tri}(t) = A \cdot \left( 4 \cdot \left| f \cdot (t+1/4) -  \left \lfloor{ \frac{1}{2} + f \cdot (t+1/4)} \right \rfloor \right| - 1 \right),
```

where $\left| \cdot \right|$ is defined by

```{math}
:label: eq:abs
    \left| x \right| = \begin{cases}
    +x & \text{ if } x \geq 0\\
    -x & \text{ else.}
    \end{cases}
```

```{figure} ../../../figs/sounddesign/triangle.png
---
width: 400px
name: fig-triangle
---
The triangle wave with a frequency and amplitude of 1.
```

Let's look at its Fourier series:

```{math}
:label: eq:triangle:fourier
    y_\text{tri}(t) = A \cdot \frac{8}{\pi^2} \cdot \sum_{k=0}^{\infty} (-1)^k \frac{\sin(2\pi \cdot f \cdot (2k+1) \cdot t)}{(2k+1)^2}
```

Again we learn from the Fourier series Eq. {eq}`eq:triangle:fourier` that

1. each odd harmonic $(2k+1)f$ with $k \in \mathbb{N}_0$ of the fundamental $f$ is present and
2. the amplitude of the harmonic $2k+1$ decreases with $8/\pi^2(2k + 1)^2$

The amplitudes decreases **quadratically** with increasing frequencies.

```{figure} ../../../figs/sounddesign/triangle_5.png
---
width: 400px
name: fig-triangle-20
---
An approximation for the Fourier series of the triangle wave with a frequency and amplitude of 1 using $n=5$.
```

In ``sclang`` we can generate the sound of a [square wave](sec-triangle-wave) using the [UGen](sec-ugens) ``LFTri``:

```isc
{LFTri.ar(220!2) * 0.25;}.play;
```