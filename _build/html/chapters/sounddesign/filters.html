
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3. Filters &#8212; Algorithmic Composition</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4. Subtractive Synthesis" href="subtractive-synthesis.html" />
    <link rel="prev" title="2. Additive Synthesis" href="additive-synthesis.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Algorithmic Composition</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  SuperCollider
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../supercollider/ecosystem.html">
   1. The Ecosystem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../supercollider/basics.html">
   2. Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../supercollider/ugens.html">
   3. Unit Generators
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Sound Design
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="terms.html">
   1. Terms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="additive-synthesis.html">
   2. Additive Synthesis
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   3. Filters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="subtractive-synthesis.html">
   4. Subtractive Synthesis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="percussive-sound.html">
   5. Percussive Sound
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="am.html">
   6. Amplitude Modulation (AM)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fm.html">
   7. Frequency Modulation (FM)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="drones.html">
   8. Drones
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../misc/bibliography.html">
   1. Bibliography
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Trash
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../trash/jump-right-in.html">
   1. Building Sounds
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../trash/distributions.html">
   2. Random distributions
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/chapters/sounddesign/filters.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#phases">
   3.1. Phases
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#smoothening">
   3.2. Smoothening
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#onezero">
   3.3. OneZero
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#onepole">
   3.4. OnePole
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lag">
   3.5. Lag
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#varlag">
   3.6. VarLag
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#phasing-filtering">
   3.7. Phasing &amp; Filtering
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#responses-and-resonance">
   3.8. Responses and Resonance
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   3.9. Summary
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="filters">
<span id="sec-filters"></span><h1><span class="section-number">3. </span>Filters<a class="headerlink" href="#filters" title="Permalink to this headline">¶</a></h1>
<p>The very basic understanding of filters might be that they just make parts of the signal quieter – which is wrong.
They do far more than just attenuate some frequencies.
Because filters often use some kind of feedback cycle, I find them difficult to understand.</p>
<div class="section" id="phases">
<h2><span class="section-number">3.1. </span>Phases<a class="headerlink" href="#phases" title="Permalink to this headline">¶</a></h2>
<p>Before we can talk about filters let us talk about phases.
As we will see we can filter a signal by using a simple oscillator.</p>
<p>Let us first combine two sine waves.
The first two identical ones</p>
<div class="amsmath math notranslate nohighlight" id="equation-2f826de2-202a-47c5-bbef-4c3da4fe5f4a">
<span class="eqno">(3.2)<a class="headerlink" href="#equation-2f826de2-202a-47c5-bbef-4c3da4fe5f4a" title="Permalink to this equation">¶</a></span>\[\begin{equation}
y_1(t) = \sin(2\pi f t) + \sin(2\pi f t) = 2 \sin(2\pi f t)
\end{equation}\]</div>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span> <span class="o">+</span> <span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">200</span><span class="p">)}.</span><span class="nx">play</span>
</pre></div>
</div>
<p>and then two where the second one is phase shifted by <span class="math notranslate nohighlight">\(\pi\)</span> that is</p>
<div class="amsmath math notranslate nohighlight" id="equation-87e3c4a1-0b35-452d-a680-0340a05d1571">
<span class="eqno">(3.3)<a class="headerlink" href="#equation-87e3c4a1-0b35-452d-a680-0340a05d1571" title="Permalink to this equation">¶</a></span>\[\begin{equation}
y_1(t) = \sin(2\pi f t) + \sin(2\pi f t + \pi) = \sin(2\pi f t) - \sin(2\pi f t + \pi) = 0
\end{equation}\]</div>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span> <span class="o">+</span> <span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="nx">pi</span><span class="p">)}.</span><span class="nx">play</span>
</pre></div>
</div>
<p>Because we shift the phase by <span class="math notranslate nohighlight">\(\pi\)</span> the resulting sound is silence!
This demonstrate the high impact of the relationships between signals with different phases.
Of course, we can not hear any difference between a sine wave and the same sine wave with some different phase.
Only in combination the phase plays a role!</p>
<p>Combining any number of signals, the maximal loudness of the sum of all signal lies within the sum of absolute maximum loudness of each signal and silence.</p>
<p>A phase of <span class="math notranslate nohighlight">\(\pi\)</span> (one half cycle) for an oscillator with a frequency of <span class="math notranslate nohighlight">\(200\)</span> Hz (<span class="math notranslate nohighlight">\(200\)</span> cycles per second) results in a shift of</p>
<div class="amsmath math notranslate nohighlight" id="equation-0c797d0a-690f-4a46-b49c-fecd6f9127e3">
<span class="eqno">(3.4)<a class="headerlink" href="#equation-0c797d0a-690f-4a46-b49c-fecd6f9127e3" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{1}{200} \cdot \frac{1}{2} = \frac{1}{400} = 0.0025
\end{equation}\]</div>
<p>seconds.
For an oscillator with a frequency of <span class="math notranslate nohighlight">\(100\)</span> Hz a phase shift of <span class="math notranslate nohighlight">\(\pi\)</span> would imply a delay of ony <span class="math notranslate nohighlight">\(0.005\)</span> seconds.</p>
<p>What is happing if we combine two <a class="reference internal" href="additive-synthesis.html#sec-sawtooth-wave"><span class="std std-ref">sawtooth waves</span></a> such that the fundamental frequencies of these two signals cancel each other out?</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nb">LFSaw</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">300</span><span class="o">!</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="nb">LFSaw</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">300</span><span class="o">!</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span><span class="p">}.</span><span class="nx">play</span><span class="p">;</span>
</pre></div>
</div>
<p>Compare this to the sound of a regular sawtooth wave:</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nb">LFSaw</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">300</span><span class="o">!</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">}.</span><span class="nx">play</span><span class="p">;</span>
</pre></div>
</div>
<p>We clearly hear some differences and if we do the math we can see why!
As before, the fundamentals of frequency <span class="math notranslate nohighlight">\(f\)</span> Hz of combining two sawtooth one shifted by <span class="math notranslate nohighlight">\(1/(2f)\)</span> seconds, cancel each other out.
However the next harmonic with frequency <span class="math notranslate nohighlight">\(2f\)</span> Hz is reinforced, that is, its amplitude is doubled.
This is because after <span class="math notranslate nohighlight">\(1/(2f)\)</span> seconds this harmonic has gone through <span class="math notranslate nohighlight">\((2f)/(2f) = 1\)</span> cycle.</p>
<p>In the fact, amplitude of each even harmonic is reinforced since</p>
<div class="amsmath math notranslate nohighlight" id="equation-39070e0e-4023-41c6-9d3d-87b2ae20ebf3">
<span class="eqno">(3.5)<a class="headerlink" href="#equation-39070e0e-4023-41c6-9d3d-87b2ae20ebf3" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{2nf}{2f} = n 
\end{equation}\]</div>
<p>is a whole number but each odd harmonic gets canceled out since</p>
<div class="amsmath math notranslate nohighlight" id="equation-5bb8e4e4-5ce5-48a9-9f1a-b9e28453b4db">
<span class="eqno">(3.6)<a class="headerlink" href="#equation-5bb8e4e4-5ce5-48a9-9f1a-b9e28453b4db" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{nf}{2f} = \frac{n}{2} = k + \frac{1}{2}
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is an odd number and <span class="math notranslate nohighlight">\(k = \mathbb{N}_0\)</span> (one odd harmonic starts at the beginning of a cycle while the second one half way through).</p>
<p>This dual character (canceling or doubling) can be much more complex, that is, some frequencies might get a bit louder some a bit reinforced, few doubled and few canceled.</p>
<p>Cancelation is equivalent to filtering!
So our examples of using two oscillators one shifted by <span class="math notranslate nohighlight">\(\pi\)</span> can be seen as filtering one oscillator by the other.
The second one acts like a filter.
This filter is called <a class="reference internal" href="terms.html#sec-comb-filter"><span class="std std-ref">Comb Filter</span></a>.
In <strong>sclang</strong> this filter is called <code class="docutils literal notranslate"><span class="pre">DelayX</span></code> where <code class="docutils literal notranslate"><span class="pre">X</span></code> stands for different interpolation techniques.</p>
<p>The following code is equivalent to the two sine waves that cancel each other out:</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">({</span>
    <span class="kd">var</span> <span class="nx">sig</span> <span class="o">=</span> <span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
    <span class="nx">sig</span> <span class="o">=</span> <span class="nx">sig</span> <span class="o">+</span> <span class="nb">DelayL</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">sig</span><span class="p">,</span> <span class="kc">maxdelaytime:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="kc">delaytime:</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">200</span><span class="p">));</span>
<span class="p">}.</span><span class="nx">play</span><span class="p">;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">CombX</span></code> is a delay line <strong>with feedback</strong>.
With <code class="docutils literal notranslate"><span class="pre">DelayL</span></code> we can achieve the filtering of the sawthoth wave without combining the sine waves by using multiple <a class="reference internal" href="../supercollider/ugens.html#def-ugen"><span class="std std-ref">UGens</span></a>.</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">({</span>
    <span class="kd">var</span> <span class="nx">sig</span> <span class="o">=</span> <span class="nb">LFSaw</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">200</span> <span class="o">!</span> <span class="mi">2</span><span class="p">);</span>
    <span class="nx">sig</span> <span class="o">=</span> <span class="nx">sig</span> <span class="o">+</span> <span class="nb">DelayL</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">sig</span><span class="p">,</span> <span class="kc">maxdelaytime:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="kc">delaytime:</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">200</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="nx">sig</span><span class="p">;</span>
<span class="p">}.</span><span class="nx">play</span><span class="p">;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="smoothening">
<h2><span class="section-number">3.2. </span>Smoothening<a class="headerlink" href="#smoothening" title="Permalink to this headline">¶</a></h2>
<p>A signal can also be filtered by smoothening it.
For example, let <span class="math notranslate nohighlight">\(\text{in}[0], \ldots, \text{in}[n]\)</span> be the discrete (input) signal of a <a class="reference internal" href="additive-synthesis.html#sec-sawtooth-wave"><span class="std std-ref">sawtooth waves</span></a> and <span class="math notranslate nohighlight">\(\text{out}[0], \ldots \text{out}[n]\)</span> be the filtered (output) signal.
If</p>
<div class="amsmath math notranslate nohighlight" id="equation-bf874ab6-8529-4407-8fce-54fc696c400f">
<span class="eqno">(3.7)<a class="headerlink" href="#equation-bf874ab6-8529-4407-8fce-54fc696c400f" title="Permalink to this equation">¶</a></span>\[\begin{equation}
    \begin{split}
    \text{out}[0] &amp;\leftarrow 0.5 \cdot \text{in}[0]\\
    \text{out}[i] &amp;\leftarrow 0.5 \cdot \text{in}[i] - 0.5 \cdot \text{in}[i-1]
    \end{split}
\end{equation}\]</div>
<p>the result is the difference quotient divided by sample rate.
All values of <span class="math notranslate nohighlight">\(\text{out}\)</span> are almost zero except at the parts which are not differentiable.</p>
<p>To achieve this effect we can use the <a class="reference internal" href="#sec-onezero"><span class="std std-ref">OneZero</span></a>-filter.</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">{[</span><span class="nb">LFSaw</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="nb">OneZero</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nb">LFSaw</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)]}.</span><span class="nx">plot</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default" id="fig-canceled-saw-onezero-filter">
<a class="reference internal image-reference" href="../../_images/canceled-saw-onezero-filter.png"><img alt="../../_images/canceled-saw-onezero-filter.png" src="../../_images/canceled-saw-onezero-filter.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3.3 </span><span class="caption-text">Canceling a sawtooth wave by applying a <code class="docutils literal notranslate"><span class="pre">OneZero</span></code>-filter. You can see peaks at values where the sawtooth is not differentiable.</span><a class="headerlink" href="#fig-canceled-saw-onezero-filter" title="Permalink to this image">¶</a></p>
</div>
<p>This works so well because the rate of change of a sawtooth wave is constant almost everywhere.</p>
<p>The integral of one phase of a sine wave is zero.
Consequently, by averaging the discrete signal to accomplish the respective sum will cancel out the sine wave, i.e., a specific frequency.
<a class="reference internal" href="#sec-onepole"><span class="std std-ref">OnePole</span></a> computes an (weighted) average via a feedback cycle resulting in an exponential drop of weights.</p>
</div>
<div class="section" id="onezero">
<span id="sec-onezero"></span><h2><span class="section-number">3.3. </span>OneZero<a class="headerlink" href="#onezero" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://doc.sccode.org/Classes/OneZero.html">OneZero</a> extends from <a class="reference external" href="https://doc.sccode.org/Classes/Filter.html">Filter</a> thus it is a filter.
I had a hard time understanding what this filter actually does to its input signal <span class="math notranslate nohighlight">\(\text{in}\)</span>, since the documentation is very minimal.
But I think I could reverse engineer its behaviour.</p>
<p>The documentation states that a one zero filter implements the formula:</p>
<div class="amsmath math notranslate nohighlight" id="equation-ff2231bc-1029-4fa4-a7da-c71bceb5983e">
<span class="eqno">(3.8)<a class="headerlink" href="#equation-ff2231bc-1029-4fa4-a7da-c71bceb5983e" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\text{out}[i] \leftarrow (1 - |\alpha|) \cdot \text{in}[i] + \alpha \cdot \text{in}[i-1]
\end{equation}\]</div>
<p>with <span class="math notranslate nohighlight">\(-1 \leq \alpha \leq 1\)</span>.
<span class="math notranslate nohighlight">\(\text{in}[i]\)</span> is actually the <span class="math notranslate nohighlight">\(i\)</span>-th sample of the discrete input signal.
Therefore, <code class="docutils literal notranslate"><span class="pre">OneZero</span></code> as well as <code class="docutils literal notranslate"><span class="pre">OnePole</span></code> depend on the sample rate / audio rate!</p>
<p>Let us use <span class="math notranslate nohighlight">\(\alpha = -0.5\)</span> and we a differentiator!
Let <span class="math notranslate nohighlight">\(y(t)\)</span> be our signal, then we basically compute</p>
<div class="amsmath math notranslate nohighlight" id="equation-f30cf920-2d67-408a-8853-789a6ee70b08">
<span class="eqno">(3.9)<a class="headerlink" href="#equation-f30cf920-2d67-408a-8853-789a6ee70b08" title="Permalink to this equation">¶</a></span>\[\begin{equation}
    \frac{y(t) - y(t - h)}{2}.
\end{equation}\]</div>
<p>To compute the difference quotient, we have to figure out what <span class="math notranslate nohighlight">\(h\)</span> is.
In other words, what is the time between <span class="math notranslate nohighlight">\(\text{in}[i]\)</span> and <span class="math notranslate nohighlight">\(\text{in}[i-1]\)</span>.
The answer is <span class="math notranslate nohighlight">\(1/a_\text{rate}\)</span> where <span class="math notranslate nohighlight">\(a_\text{rate}\)</span> is the audio rate.</p>
<p>To compute the difference quotient we use the following formula:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d173fd19-f232-4c3b-a2b4-a998a07337d1">
<span class="eqno">(3.10)<a class="headerlink" href="#equation-d173fd19-f232-4c3b-a2b4-a998a07337d1" title="Permalink to this equation">¶</a></span>\[\begin{equation}
    \frac{y(t) - y(t - h)}{2} \cdot \frac{2}{h}.
\end{equation}\]</div>
<p>Using the discrete input signal <span class="math notranslate nohighlight">\(\text{in}\)</span> gives us:</p>
<div class="amsmath math notranslate nohighlight" id="equation-c2292c70-3a93-4f36-a185-e32a8f0f0bcf">
<span class="eqno">(3.11)<a class="headerlink" href="#equation-c2292c70-3a93-4f36-a185-e32a8f0f0bcf" title="Permalink to this equation">¶</a></span>\[\begin{equation}
    \frac{\text{in}[i] - \text{in}[i-1]}{2} \cdot \frac{2}{a_\text{rate}}.
\end{equation}\]</div>
<p>To test this result, let us compute the cosine using <code class="docutils literal notranslate"><span class="pre">SinOsc</span></code> and a <code class="docutils literal notranslate"><span class="pre">OneZero</span></code>.
Remember</p>
<div class="amsmath math notranslate nohighlight" id="equation-1a24e0b1-c801-40ed-9169-e1670931a829">
<span class="eqno">(3.12)<a class="headerlink" href="#equation-1a24e0b1-c801-40ed-9169-e1670931a829" title="Permalink to this equation">¶</a></span>\[\begin{equation}
    \frac{d\sin(2\pi \cdot f \cdot t)}{dt} = 2 \pi \cdot f \cdot \cos(2\pi \cdot f \cdot t) 
\end{equation}\]</div>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">({</span>
    <span class="kd">var</span> <span class="nx">freq</span> <span class="o">=</span> <span class="mi">220</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">sample_rate</span> <span class="o">=</span> <span class="mi">48000</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">dt</span> <span class="o">=</span> <span class="nx">sample_rate</span><span class="p">.</span><span class="nx">reciprocal</span><span class="p">;</span>
    <span class="p">[</span><span class="nb">OneZero</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">freq</span><span class="p">),</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="nx">dt</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">pi</span> <span class="o">*</span> <span class="nx">freq</span><span class="p">),</span> <span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">freq</span><span class="p">)]</span>
<span class="p">}.</span><span class="nx">plot</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">220</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default" id="fig-all-sin-deviation">
<a class="reference internal image-reference" href="../../_images/sin_deviation.png"><img alt="../../_images/sin_deviation.png" src="../../_images/sin_deviation.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3.4 </span><span class="caption-text">At the top the cosine generated by the bottom signal and a <code class="docutils literal notranslate"><span class="pre">OneZero</span></code>-<code class="docutils literal notranslate"><span class="pre">UGen</span></code>.</span><a class="headerlink" href="#fig-all-sin-deviation" title="Permalink to this image">¶</a></p>
</div>
<div class="hint admonition">
<p class="admonition-title">Slope UGen</p>
<p>The <a class="reference external" href="https://doc.sccode.org/Classes/Slope.html">Slope</a>-<code class="docutils literal notranslate"><span class="pre">UGen</span></code> can also be used to compute the slope of a signal.</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="nb">Slope</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">freq</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">pi</span> <span class="o">*</span> <span class="nx">freq</span><span class="p">);</span>
</pre></div>
</div>
<p>gives us the cosine.</p>
</div>
<p>If we use <span class="math notranslate nohighlight">\(\alpha = 1.0\)</span> we generate a single sample delay and for -1.0 we additionally mirror the signal at the <span class="math notranslate nohighlight">\(x\)</span>-axis.</p>
</div>
<div class="section" id="onepole">
<span id="sec-onepole"></span><h2><span class="section-number">3.4. </span>OnePole<a class="headerlink" href="#onepole" title="Permalink to this headline">¶</a></h2>
<p>Another <code class="docutils literal notranslate"><span class="pre">UGen</span></code> I have a hard time get my head around is <code class="docutils literal notranslate"><span class="pre">OnePole</span></code>.
The documentation states that a one pole filter implements the formula:</p>
<div class="math notranslate nohighlight" id="equation-eq-onepole">
<span class="eqno">(3.13)<a class="headerlink" href="#equation-eq-onepole" title="Permalink to this equation">¶</a></span>\[    \text{out}[i] \leftarrow (1 - |\alpha|) \cdot \text{in}[i] + \alpha \cdot \text{out}[i-1]\]</div>
<p>with <span class="math notranslate nohighlight">\(-1 \leq \alpha \leq 1\)</span>.
I assume</p>
<div class="amsmath math notranslate nohighlight" id="equation-9f79082f-fe62-498a-9c60-145e02493abc">
<span class="eqno">(3.14)<a class="headerlink" href="#equation-9f79082f-fe62-498a-9c60-145e02493abc" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\text{out}[0] \leftarrow (1 - |\alpha|) \cdot \text{in}[0]
\end{equation}\]</div>
<p>holds. <span class="math notranslate nohighlight">\(\text{out}\)</span> is the resulting signal and <span class="math notranslate nohighlight">\(\text{in}\)</span> the input signal of <code class="docutils literal notranslate"><span class="pre">OnePole</span></code>.
Let us assume <span class="math notranslate nohighlight">\(1 \geq \alpha \geq 0\)</span>, then we can rearrange Eq. <a class="reference internal" href="#equation-eq-onepole">(3.13)</a>:</p>
<div class="math notranslate nohighlight" id="equation-eq-onepole2">
<span class="eqno">(3.15)<a class="headerlink" href="#equation-eq-onepole2" title="Permalink to this equation">¶</a></span>\[    \text{out}[i] \leftarrow \text{in}[i] + \alpha \cdot (\text{out}[i-1] - \text{in}[i])\]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-eq-onepole3">
<span class="eqno">(3.16)<a class="headerlink" href="#equation-eq-onepole3" title="Permalink to this equation">¶</a></span>\[    \text{out}[i] \leftarrow \text{out}[i-1] + \beta \cdot (\text{in}[i] - \text{out}[i-1])\]</div>
<p>with <span class="math notranslate nohighlight">\(\beta = 1-\alpha\)</span>.
If <span class="math notranslate nohighlight">\(\beta\)</span> is small, (<span class="math notranslate nohighlight">\(\alpha\)</span> is large respectively), then output samples <span class="math notranslate nohighlight">\(\text{out}[0], \ldots \text{out}[n]\)</span> respond more slowly to a change in the input samples <span class="math notranslate nohighlight">\(\text{in}[0], \ldots \text{in}[n]\)</span>. For example,</p>
<div class="amsmath math notranslate nohighlight" id="equation-edf3e409-9281-4f77-87e5-3384523291fe">
<span class="eqno">(3.17)<a class="headerlink" href="#equation-edf3e409-9281-4f77-87e5-3384523291fe" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\begin{split}
\text{out}[2] &amp; \leftarrow \text{out}[1] + \beta \cdot (\text{in}[2] - \text{out}[1]) \\
  &amp; = \text{in}[2] \cdot \beta + \text{in}[1] \cdot (\beta - \beta^2) + \text{in}[0] \cdot (\beta - 2\beta^2 + \beta^3)\\
  &amp; = \beta \cdot (\text{in}[2] + \text{in}[1] \cdot (1 - \beta) + \text{in}[0] \cdot (1 - \beta)^2) \\
  &amp; = (1-\alpha) \cdot (\text{in}[2] + \text{in}[1] \cdot \alpha + \text{in}[0] \cdot \alpha^2)
\end{split}
\end{equation}\]</div>
<p>and in general we get</p>
<div class="amsmath math notranslate nohighlight" id="equation-e6c26535-a488-46e4-833d-96cd8a23a33e">
<span class="eqno">(3.18)<a class="headerlink" href="#equation-e6c26535-a488-46e4-833d-96cd8a23a33e" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\begin{split}
\text{out}[i] \leftarrow (1-\alpha) \cdot \sum\limits_{k=0}^{i} \alpha^{i-k} \cdot \text{in}[k].
\end{split}
\end{equation}\]</div>
<p>The change from one filter output to the next is proportional to the difference between the previous output and the next input.
Therefore, the signal is smoothen exponentially, which matches the exponential decay seen in the continuous-time system.
The exponential decay is depicted in <a class="reference internal" href="#fig-lag-and-onepole"><span class="std std-numref">Fig. 3.5</span></a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">OnePole</span></code> is a low-pass filter.
Compare. for example, the following similar sounding signals of a <a class="reference internal" href="additive-synthesis.html#sec-sawtooth-wave"><span class="std std-ref">sawtooth wave</span></a>, first filtered by the low-pass filter <code class="docutils literal notranslate"><span class="pre">LPF</span></code> and then filtered by <code class="docutils literal notranslate"><span class="pre">OnePole</span></code> using a large <span class="math notranslate nohighlight">\(\alpha\)</span>:</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nb">LPF</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nb">Saw</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">440</span><span class="p">),</span> <span class="mi">400</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span><span class="p">;}.</span><span class="nx">play</span>
<span class="p">{</span><span class="nb">OnePole</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nb">Saw</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">440</span><span class="p">),</span> <span class="kc">coef:</span> <span class="mf">0.98</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span><span class="p">;}.</span><span class="nx">play</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">OnePole</span></code> simulates a simple (analog/electrical) RC-filter (resistance, capacity).
In the <a class="reference external" href="https://en.wikipedia.org/wiki/Low-pass_filter">Wikipedia article</a> about low-pass filters, you can find some additional explanations regarding the relationship between the continuous electrical and discrete digital filter.</p>
</div>
<div class="section" id="lag">
<span id="sec-lag"></span><h2><span class="section-number">3.5. </span>Lag<a class="headerlink" href="#lag" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Lag</span></code>-<code class="docutils literal notranslate"><span class="pre">UGen</span></code> is similar to <code class="docutils literal notranslate"><span class="pre">OnePole</span></code> but it has a more meaningful parameter, called <code class="docutils literal notranslate"><span class="pre">lagTime</span></code>.
I do not yet fully understand what it means but basically it is the time frame for which the signal should be smoothen.</p>
<p>The following code plots a the signal of a noise generator which generates a random value every <code class="docutils literal notranslate"><span class="pre">1/freq</span></code> seconds.
We smoothen the noise by a <code class="docutils literal notranslate"><span class="pre">OnePole</span></code> and by <code class="docutils literal notranslate"><span class="pre">Lag</span></code>.
Our frequency is 10 Hz and our <code class="docutils literal notranslate"><span class="pre">lagTime</span></code> is 0.1 seconds.</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">({</span>
    <span class="kd">var</span> <span class="nx">freq</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">noise</span> <span class="o">=</span> <span class="nb">LFNoise0</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">freq</span><span class="p">);</span>
    <span class="p">[</span><span class="nx">noise</span><span class="p">,</span> <span class="nb">OnePole</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">noise</span><span class="p">,</span> <span class="kc">coef:</span> <span class="mf">0.999</span><span class="p">),</span> <span class="nb">Lag</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">noise</span><span class="p">,</span> <span class="kc">lagTime:</span> <span class="nx">freq</span><span class="p">.</span><span class="nx">reciprocal</span><span class="p">)];</span>
<span class="p">}.</span><span class="nx">plot</span><span class="p">(</span><span class="mf">2.0</span><span class="p">))</span>
</pre></div>
</div>
<p>This gives us the following plot.</p>
<div class="figure align-default" id="fig-lag-and-onepole">
<a class="reference internal image-reference" href="../../_images/lag-and-onepole.png"><img alt="../../_images/lag-and-onepole.png" src="../../_images/lag-and-onepole.png" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3.5 </span><span class="caption-text">A filtered random signal. First we apply <code class="docutils literal notranslate"><span class="pre">OnePole</span></code> and <code class="docutils literal notranslate"><span class="pre">Lag</span></code> which gives us roughly the same result.</span><a class="headerlink" href="#fig-lag-and-onepole" title="Permalink to this image">¶</a></p>
</div>
<p>Since <code class="docutils literal notranslate"><span class="pre">Lag</span></code> is often used to smoothen changing parameters, for example in a performance, SC supports a syntactical shorthand:</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="nb">LFNoise0</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">freq</span><span class="p">).</span><span class="nx">lag</span><span class="p">(</span><span class="mf">0.1</span><span class="p">);</span>
</pre></div>
</div>
<p>Let us try to the 440 Hz part of a signal consisting of 440 and 40 Hz.</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">440</span><span class="p">)</span><span class="o">+</span><span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span><span class="p">;}.</span><span class="nx">plot</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">40</span><span class="p">)</span>
<span class="p">{</span><span class="mf">3.8</span><span class="o">*</span><span class="nb">Lag</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">440</span><span class="p">)</span><span class="o">+</span><span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span> <span class="kc">lagTime:</span> <span class="mi">300</span><span class="o">/</span><span class="mi">440</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span><span class="p">;}.</span><span class="nx">plot</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default" id="fig-lag-filtering">
<a class="reference internal image-reference" href="../../_images/lag-filtering.png"><img alt="../../_images/lag-filtering.png" src="../../_images/lag-filtering.png" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3.6 </span><span class="caption-text">A signal consisting of 440 HZ and 40 Hz partial (left) filtered by <code class="docutils literal notranslate"><span class="pre">Lag</span></code> (right).</span><a class="headerlink" href="#fig-lag-filtering" title="Permalink to this image">¶</a></p>
</div>
<p>As we increase the <code class="docutils literal notranslate"><span class="pre">lagTime</span></code> we have to boost the amplitude of the signal.</p>
</div>
<div class="section" id="varlag">
<span id="sec-varlag"></span><h2><span class="section-number">3.6. </span>VarLag<a class="headerlink" href="#varlag" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">VarLag</span></code> is similar to <code class="docutils literal notranslate"><span class="pre">Lag</span></code> but with other curve shapes than exponential but it works only on control rate signals <code class="docutils literal notranslate"><span class="pre">kr</span></code>!
Compare the different shapes of the lag:</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">({</span>
    <span class="kd">var</span> <span class="nx">freq</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">noise</span> <span class="o">=</span> <span class="nb">LFNoise0</span><span class="p">.</span><span class="kd">kr</span><span class="p">(</span><span class="nx">freq</span><span class="p">);</span>
    <span class="p">[</span>
        <span class="nx">noise</span><span class="p">,</span> 
        <span class="nb">VarLag</span><span class="p">.</span><span class="kd">kr</span><span class="p">(</span><span class="nx">noise</span><span class="p">,</span> <span class="kc">time:</span> <span class="nx">freq</span><span class="p">.</span><span class="nx">reciprocal</span><span class="p">,</span> <span class="kc">warp:</span> <span class="ss">\sine</span><span class="p">),</span> 
        <span class="nb">VarLag</span><span class="p">.</span><span class="kd">kr</span><span class="p">(</span><span class="nx">noise</span><span class="p">,</span> <span class="kc">time:</span> <span class="nx">freq</span><span class="p">.</span><span class="nx">reciprocal</span><span class="p">,</span> <span class="kc">warp:</span> <span class="ss">\linear</span><span class="p">),</span> 
        <span class="nb">Lag</span><span class="p">.</span><span class="kd">kr</span><span class="p">(</span><span class="nx">noise</span><span class="p">,</span> <span class="kc">lagTime:</span> <span class="nx">freq</span><span class="p">.</span><span class="nx">reciprocal</span><span class="p">)</span>
    <span class="p">];</span>
<span class="p">}.</span><span class="nx">plot</span><span class="p">(</span><span class="mf">2.0</span><span class="p">))</span>
</pre></div>
</div>
<div class="figure align-default" id="fig-var-lag">
<a class="reference internal image-reference" href="../../_images/var-lag.png"><img alt="../../_images/var-lag.png" src="../../_images/var-lag.png" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3.7 </span><span class="caption-text">A filtered random signal. First we apply <code class="docutils literal notranslate"><span class="pre">OnePole</span></code> and <code class="docutils literal notranslate"><span class="pre">Lag</span></code> which gives us roughly the same result.</span><a class="headerlink" href="#fig-var-lag" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="phasing-filtering">
<h2><span class="section-number">3.7. </span>Phasing &amp; Filtering<a class="headerlink" href="#phasing-filtering" title="Permalink to this headline">¶</a></h2>
<p>If we speak of filters we often man low pass or high pass filters, that is, filters that filter frequencies above or below some cutoff frequency.
For example the low pass filter <code class="docutils literal notranslate"><span class="pre">LPF</span></code> in <strong>sclang</strong> is a 2nd order Butterworth lowpass filter.</p>
<div class="figure align-default" id="fig-butterworth-filter">
<a class="reference internal image-reference" href="../../_images/butterworth-filter.png"><img alt="../../_images/butterworth-filter.png" src="../../_images/butterworth-filter.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3.8 </span><span class="caption-text">By Alejo2083 - Own work, CC BY-SA 3.0, <a class="reference external" href="https://commons.wikimedia.org/w/index.php?curid=735081">link</a>.</span><a class="headerlink" href="#fig-butterworth-filter" title="Permalink to this image">¶</a></p>
</div>
<p>The filter reduces the gain (amplitude) for frequencies above the cutoff frequency and shifts their phases.
Well, that is not completely true because the cutoff frequency is also reduced by 3 <a class="reference internal" href="terms.html#sec-intensity"><span class="std std-ref">decibel (dB)</span></a>, so the reduction starts a little bit below the cutoff frequency.
Reducing the loudness by 3 dB means that the perceived level is reduced by a factor of 2.
The top plot of <a class="reference internal" href="#fig-butterworth-filter"><span class="std std-numref">Fig. 3.8</span></a> shows the reduction in amplitude.</p>
<p>The second effect of the filter is a shift in phase, compare the bottom plot of <a class="reference internal" href="#fig-butterworth-filter"><span class="std std-numref">Fig. 3.8</span></a>.
This effect is important if we want to combine multiple filters because they interact!
In other words: we can not just combine a high pass and low pass filter to get the same result of a band pass filter!</p>
<p>The following code is an example for a band pass filter.
First we use a low pass and high pass filter, then a band pass filter.
The results sound very similar but not identical.</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">({</span>
    <span class="kd">var</span> <span class="nx">sig</span> <span class="o">=</span> <span class="nb">LFSaw</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span> <span class="o">!</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="nx">sig</span> <span class="o">=</span> <span class="nb">HPF</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">sig</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
    <span class="nx">sig</span> <span class="o">=</span> <span class="nb">LPF</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">sig</span><span class="p">,</span> <span class="mi">300</span><span class="p">);</span>
    <span class="nx">sig</span>
<span class="p">}.</span><span class="nx">play</span><span class="p">;)</span>

<span class="p">({</span>
    <span class="kd">var</span> <span class="nx">sig</span> <span class="o">=</span> <span class="nb">LFSaw</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span> <span class="o">!</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">bandwidth</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">cuttoffFeq</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
    <span class="nx">sig</span> <span class="o">=</span> <span class="nb">BPF</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">sig</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="kc">rq:</span> <span class="nx">bandwidth</span> <span class="o">/</span> <span class="nx">cuttoffFeq</span><span class="p">);</span>
    <span class="nx">sig</span>
<span class="p">}.</span><span class="nx">play</span><span class="p">;)</span>
</pre></div>
</div>
<p>For completeness I also want to mention the inverse filter of a band pass filter: the band reject filter <code class="docutils literal notranslate"><span class="pre">BRF</span></code>.</p>
<p>The following example rejects frequencies between 200 and 300 Hz, i.e., the inverse operation as before.</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">({</span>
    <span class="kd">var</span> <span class="nx">sig</span> <span class="o">=</span> <span class="nb">LFSaw</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span> <span class="o">!</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">bandwidth</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">cuttoffFeq</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
    <span class="nx">sig</span> <span class="o">=</span> <span class="nb">BRF</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">sig</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="kc">rq:</span> <span class="nx">bandwidth</span> <span class="o">/</span> <span class="nx">cuttoffFeq</span><span class="p">);</span>
    <span class="nx">sig</span>
<span class="p">}.</span><span class="nx">play</span><span class="p">;)</span>
</pre></div>
</div>
</div>
<div class="section" id="responses-and-resonance">
<h2><span class="section-number">3.8. </span>Responses and Resonance<a class="headerlink" href="#responses-and-resonance" title="Permalink to this headline">¶</a></h2>
<p>To bring dynamic into the sound by a filter, we can do the obvious: change the cuttoff frequency over time!
Let us try this with a low pass filter:</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
<span class="nb">Spec</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="ss">\modfreq</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]);</span>
<span class="nb">Spec</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="ss">\freq</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]);</span>
<span class="nb">Spec</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="ss">\mincutoff</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]);</span>
<span class="nb">Spec</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="ss">\maxcutoff</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]);</span>

<span class="nb">Ndef</span><span class="p">(</span><span class="ss">\filtering</span><span class="p">,</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">sig</span> <span class="o">=</span> <span class="nb">Saw</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="ss">\freq</span><span class="p">.</span><span class="kd">kr</span><span class="p">(</span><span class="mi">400</span><span class="p">))</span> <span class="o">!</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">cuttoff</span> <span class="o">=</span> <span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="ss">\modfreq</span><span class="p">.</span><span class="kd">kr</span><span class="p">(</span><span class="mi">10</span><span class="p">)).</span><span class="nx">range</span><span class="p">(</span><span class="ss">\mincutoff</span><span class="p">.</span><span class="kd">kr</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="ss">\maxcutoff</span><span class="p">.</span><span class="kd">kr</span><span class="p">(</span><span class="mi">1000</span><span class="p">));</span>
    <span class="nx">sig</span> <span class="o">=</span> <span class="nb">LPF</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">sig</span><span class="p">,</span> <span class="nx">cuttoff</span><span class="p">);</span>
<span class="p">}).</span><span class="nx">play</span><span class="p">;</span>
<span class="p">)</span>

<span class="nb">Ndef</span><span class="p">(</span><span class="ss">\filtering</span><span class="p">).</span><span class="nx">gui</span><span class="p">;</span>
</pre></div>
</div>
<p>Almost all physical objects resonate.
Or, to put it another way, almost all objects will vibrate naturally at certain frequencies.
What happens to musical objects such as a string when we do not play/pluck them but they are in an environment where sound is generated.
In other words: how does such an object interact with vibrations of other objects?</p>
<p>What we observe in that case is <strong>resonance</strong>!
If the musical object is excited by frequencies that coincide with its natural resonant frequencies, then it will vibrate in sympathy with the source oscillator.
Otherwise it will approximately ‘stand still’.
How a musical instrument resonate has a great effect on the color of its sound (<a class="reference internal" href="terms.html#sec-timbre"><span class="std std-ref">timbre</span></a>).</p>
<p>Resonance filters boost certain frequencies, making the harmonics at those frequencies louder than they were in the input signal.
The effect is sounds like resonance.
Therefore, resonance filters emulate resonance.</p>
<p>Which frequencies are boosted?
For most resonance filters, the frequencies near the cutoff frequency are boosted.
In <strong>sclang</strong> the <a class="reference internal" href="../supercollider/ugens.html#def-ugen"><span class="std std-ref">UGens</span></a> resonance filter start with an <code class="docutils literal notranslate"><span class="pre">R</span></code>, for example, <code class="docutils literal notranslate"><span class="pre">RLPF</span></code> is the resonance low pass filter.</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
<span class="nb">Spec</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="ss">\modfreq</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]);</span>
<span class="nb">Spec</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="ss">\freq</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]);</span>
<span class="nb">Spec</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="ss">\mincutoff</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]);</span>
<span class="nb">Spec</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="ss">\maxcutoff</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]);</span>
<span class="nb">Spec</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="ss">\bandwidth</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">]);</span>

<span class="nb">Ndef</span><span class="p">(</span><span class="ss">\filtering</span><span class="p">,</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">sig</span> <span class="o">=</span> <span class="nb">Saw</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="ss">\freq</span><span class="p">.</span><span class="kd">kr</span><span class="p">(</span><span class="mi">400</span><span class="p">))</span> <span class="o">!</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">cuttoff</span> <span class="o">=</span> <span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="ss">\modfreq</span><span class="p">.</span><span class="kd">kr</span><span class="p">(</span><span class="mi">10</span><span class="p">)).</span><span class="nx">range</span><span class="p">(</span><span class="ss">\mincutoff</span><span class="p">.</span><span class="kd">kr</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="ss">\maxcutoff</span><span class="p">.</span><span class="kd">kr</span><span class="p">(</span><span class="mi">1000</span><span class="p">));</span>
    <span class="nx">sig</span> <span class="o">=</span> <span class="nb">RLPF</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">sig</span><span class="p">,</span> <span class="nx">cuttoff</span><span class="p">,</span> <span class="kc">rq:</span> <span class="ss">\bandwidth</span><span class="p">.</span><span class="kd">kr</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="nx">cuttoff</span><span class="p">);</span>
<span class="p">}).</span><span class="nx">play</span><span class="p">;</span>
<span class="p">)</span>
<span class="nb">Ndef</span><span class="p">(</span><span class="ss">\filtering</span><span class="p">).</span><span class="nx">gui</span><span class="p">;</span>
</pre></div>
</div>
<p>Try different values especially for the bandwidth.
A small bandwidth will result in a strong effect.</p>
<p>In fact, if the bandwidth is very small, the effect becomes so pronounced that the high and low frequencies disappear from the signal and another effect occurs: the filter begins to oscillate at its cutoff frequency.
The result is a powerful unnatural sound unique to the electronic synthesizer.</p>
</div>
<div class="section" id="summary">
<h2><span class="section-number">3.9. </span>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Filters are essential for <em>subtractive synthesis</em>.
Filters do not only change the level of certain frequencies but apply a phase shift.
Many of the filters only apply such a shift and we often do not think of them as filters.</p>
<p>Let me summarize some of the applications of filters:</p>
<ul class="simple">
<li><p>We can use static filters to emphasis certain frequencies.</p></li>
<li><p>We can use static filters to create formants in a sound, and imitate the characteristics of the human voice or traditional acoustic instruments.</p></li>
<li><p>A <em>resonance filter</em> with a moderate <em>resonance bandwidth</em> with a cuttoff frequency that tracks the pitch, can create a characteristic quality that remains tonally consistent as we play the keyboard.</p></li>
<li><p>For some <em>resonance filters</em>, if we decrease the <em>resonance bandwidth</em> we enter an area where the filter is at the brick of self-oscillation. This creates a distinctive distortion that can be a very good starting point.</p></li>
<li><p>If we decrease the <em>resonance bandwidth</em> even further, the filter will become a sine wave generator in its own right. In theory, no input signal is passed at this point, but few filters completely remove all the signal, and the result is a tortured sound that has extensive uses in modern music.</p></li>
</ul>
<p>In analogue synthesis, filters are the defining element of a synthesizer!
They are crucial, also in digital synthesis, and if you are into creative synthesis, your sound generation will depend upon what you have got and what you do with it</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/sounddesign"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="additive-synthesis.html" title="previous page"><span class="section-number">2. </span>Additive Synthesis</a>
    <a class='right-next' id="next-link" href="subtractive-synthesis.html" title="next page"><span class="section-number">4. </span>Subtractive Synthesis</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Benedikt Zönnchen<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>