
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fourier Series &#8212; Algorithmic Composition</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/tabs.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Fourier Transform" href="fourier-transform.html" />
    <link rel="prev" title="Complex Numbers" href="complex.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Algorithmic Composition</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../intro.html">
   Preamble
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  SuperCollider I
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../supercollider/ecosystem.html">
   The Ecosystem
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../supercollider/basics/basics.html">
   Basics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/basics/1-code-execution.html">
     Code Execution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/basics/2-variables.html">
     Variables and Scope
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/basics/3-arrays.html">
     Arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/basics/4-functions.html">
     Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/basics/5-control-structures.html">
     Control Structures
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/basics/6-classes.html">
     Classes and Objects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/basics/7-playing.html">
     Playing Sound
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/basics/8-environments.html">
     Environments
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../supercollider/synths.html">
   Synthesizers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../supercollider/ugens.html">
   Unit Generators
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  SuperCollider II
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../supercollider/pattern/pattern.html">
   Playing Patterns
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/pattern/1-the-instrument.html">
     The Instrument and its Artist
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/pattern/2-streams.html">
     Streams
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/pattern/3-pattern.html">
     Pattern
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/pattern/4-events.html">
     Musical Event
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/pattern/5-event-player.html">
     Event Player
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../supercollider/live-coding/live-coding.html">
   Live Coding
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/live-coding/1-proxies.html">
     Proxies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/live-coding/2-node-proxies.html">
     Node Proxies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/live-coding/3-node-proxy-defs.html">
     Node Proxy Definition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/live-coding/4-proxy-space.html">
     Proxy Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/live-coding/5-task-proxies.html">
     Task Proxy
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../supercollider/scheduling/scheduling.html">
   Scheduling
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/scheduling/1-connecting-times.html">
     The Entanglement of Time
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/scheduling/2-clocks.html">
     Clocks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/scheduling/3-routines-tasks.html">
     Routines &amp; Tasks
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../supercollider/communication/communication.html">
   Communication
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/communication/1-midi.html">
     Musical Instrument Digital Interface
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../supercollider/communication/2-osc.html">
     Open Sound Control
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../supercollider/ugens2.html">
   Unit Generator Library
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Sound Design
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Mathematical Foundation
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="sampling.html">
     Sampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="complex.html">
     Complex Numbers
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Fourier Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="fourier-transform.html">
     Fourier Transform
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dft.html">
     Discrete Fourier Transform
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="convolution.html">
     Convolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="z-transform.html">
     Z-Transform
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lti-filters.html">
     LTI Filters
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../abstract-and-physical.html">
   Abstract and Physical Synthesis
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../additive-synthesis/additive-synthesis.html">
   Additive Synthesis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../additive-synthesis/1-waveforms.html">
     Fundamental Waveforms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../additive-synthesis/2-sine-sum.html">
     A Sum of Sines
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../filters/filters.html">
   Subtractive Synthesis and Filters
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../filters/1-phase-shifting.html">
     Filtering by Delay
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../filters/3-simpler-filters.html">
     Basic Filters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../filters/4-frequency-filters.html">
     Frequency Filters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../filters/5-resonance.html">
     Responses and Resonance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../filters/6-control-filters.html">
     Control Filters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../filters/7-delays.html">
     Delays
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../am.html">
   Amplitude Modulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../fm.html">
   Frequency Modulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../physical-modeling.html">
   Physical Modeling
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../cookbook/intro.html">
   Cookbook
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../cookbook/drones.html">
     Drones
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cookbook/percussive-sound.html">
     Percussive Sound
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Composing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../composing/introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../composing/music-theory/music-theory.html">
   Music Theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../composing/music-theory/1-intervals.html">
     Intervals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../composing/music-theory/2-scales.html">
     Scales, Modes and Keys
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../composing/music-theory/5-tuning.html">
     Tuning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../composing/music-theory/6-chords.html">
     Chords
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../composing/music-theory/7-midinotes.html">
     Midi Notes
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../misc/about.html">
   About the Book
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../misc/terms.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../misc/bibliography.html">
   Bibliography
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Trash
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../trash/jump-right-in.html">
   Building Sounds
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../trash/distributions.html">
   Random distributions
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../../../_sources/chapters/sounddesign/math/fourier-series.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/chapters/sounddesign/math/fourier-series.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/chapters/sounddesign/math/fourier-series.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#frequency-spectrum">
   Frequency Spectrum
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#similarity-of-periodic-functions">
   Similarity of Periodic Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fourier-synthesis">
   Fourier Synthesis
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fourier-analysis">
   Fourier Analysis
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Fourier Series</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#frequency-spectrum">
   Frequency Spectrum
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#similarity-of-periodic-functions">
   Similarity of Periodic Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fourier-synthesis">
   Fourier Synthesis
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fourier-analysis">
   Fourier Analysis
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="fourier-series">
<span id="sec-fourier"></span><h1>Fourier Series<a class="headerlink" href="#fourier-series" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>L’étude profonde de la nature est la source la plus féconde de découvertes mathématiques. – Jean-Baptiste Joseph Fourier (1768–1830)</p>
</div></blockquote>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">librosa</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">import</span> <span class="nn">librosa.display</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;librosa&#39;
</pre></div>
</div>
</div>
</div>
<p>Given a signal <span class="math notranslate nohighlight">\(y(t)\)</span> of a played piano key, how can we compute the pitch, and how can we recreate that sound?
Spectral analysis and synthesis give us some answers.
By <em>transforming</em> the representation of a signal, we can catapult ourselves from the space of amplitude over time into the space of intensity over frequencies.</p>
<p>In mathematics, the meaning of <em>transform</em> and <em>transformation</em> is somewhat specific, but it still is relatively wide or loose when the definition sometimes says it is a mathematical quantity obtained from a given quality by an algebraic, geometric, or functional operation.
In <em>transform theory</em>, mathematicians talk about a suitable choice of a function called <em>kernel</em> (from the German <em>nucleus</em> or <em>core</em>), by which a problem may be simplified.</p>
<p>In 1822 <em>Jean-Baptise Joseph Fourier</em> discovered a truly remarkable <em>transformation</em> which gives us insights into our knowledge of waveforms in general and music in particular.
He claimed that any function, whether continuous or discontinuous, can be transformed into a series of sines.
That important work was corrected to</p>
<blockquote>
<div><p>Almost any periodic function can be represented by a Fourier series that converges.</p>
</div></blockquote>
<p>and expanded upon by others to provide the foundation for various forms of the Fourier transform used since.</p>
<p>I find this result still fascinating.
At this point, I have to mention that the great German mathematician <em>Carl Friedrich Gauß</em> already discovered this connection in 1805 and, what is even more remarkable, he formulated something quite similar to the <strong>fast Fourier transform (FFT)</strong>!
His breakthrough was not widely adopted because it only appeared after his death in <em>volume three of his collected works</em> which was written with non-standard notation in a 19th-century version of Latin.</p>
<p>Especially since the re-discovery of the <em>fast Fourier transform (FFT)</em> in 1965 by <em>Cooley</em> and <em>Tukey</em> to detect underground tests of atomic bombs, the Fourier synthesis is a widespread technique performed in all areas of signal processing.
There are so many applications of the FFT, from solving differential equations to radar and sonar, studying crystal structures, WiFi, and 5G.
It is no surprise that the mathematician <em>Gilbert Strang</em> called the FFT</p>
<blockquote>
<div><p>The most important numerical algorithm of our lifetime. – Gilbert Strang</p>
</div></blockquote>
<p>But why is that?
Well, it is all about computation speed!
The <em>FFT</em> reduces the time complexity of the <em><a class="reference internal" href="dft.html#def-discrete-fourier-transform"><span class="std std-ref">discrete Fourier transformation (DFT)</span></a></em> from <span class="math notranslate nohighlight">\(\mathcal{O}(n^2)\)</span> to <span class="math notranslate nohighlight">\(\mathcal{O}(n\log(n))\)</span> which makes the computation of the <em>DFT</em> fast thus applicable for many areas and purposes.</p>
<div class="section" id="frequency-spectrum">
<span id="sec-freq-spectrum"></span><h2>Frequency Spectrum<a class="headerlink" href="#frequency-spectrum" title="Permalink to this headline">¶</a></h2>
<p>Before we dicuss the mathematical basis, let’s have a look at the <em>frequency spectrum</em> of a audio recordings such that we can picture what we want to compute.
First let us use an audio recording of a physical piano.
The note played is A0 = 440 Hz.</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>We can display the wave form of the signal</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>as well as the frequency sprectrum</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>The spectrum is computed by the <a class="reference internal" href="dft.html#sec-dft"><span class="std std-ref">discrete Fourier transform</span></a>.
As you can see, there are even lower frequencies than the fundamental present and the signal consists of a lot <em>inharmonic</em> content.
The piano might be out of tune.</p>
<p>Let us look at a second synthetic example:</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>The sound was generated by the following code.</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">({</span>
    <span class="kd">var</span> <span class="nx">sig</span> <span class="o">=</span> <span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">440</span> <span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span> <span class="o">*</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">];</span>
    <span class="nx">sig</span> <span class="o">=</span> <span class="nb">Mix</span><span class="p">(</span><span class="nx">sig</span><span class="p">);</span>
    <span class="p">[</span><span class="nx">sig</span><span class="p">,</span> <span class="nx">sig</span><span class="p">];</span>
<span class="p">}.</span><span class="nx">play</span><span class="p">;)</span>
</pre></div>
</div>
<p>We can display the wave form of the signal (here I only plot a very short time period)</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>as well as the frequency sprectrum</p>
<div class="cell tag_remove-input docutils container">
</div>
<p>In the synthetic case, we get exaclty what we expected, i.e., 5 peaks, four <em>harmonic overtones</em>, and one fundamental at 440 Hz.</p>
</div>
<div class="section" id="similarity-of-periodic-functions">
<span id="sec-similarity-of-functions"></span><h2>Similarity of Periodic Functions<a class="headerlink" href="#similarity-of-periodic-functions" title="Permalink to this headline">¶</a></h2>
<p>Let us start from the assumption that the <em><a class="reference internal" href="#theorem-fourier-synthesis"><span class="std std-ref">Fourier Theorem</span></a></em> is correct (which it is).
So we assume, that we can built any periodic vibration using a combination of sinusiods whose frequencies are integer multiple of a fundamental frequcency.
Our job is to find the correct <strong>amplitudes</strong> and <strong>phases</strong> of these sinusiods.
Let’s ignore the phase for a moment.
We assume that all phases are zero.</p>
<p>The question that we have to answer is: how much of a specific sinusoidal is in <span class="math notranslate nohighlight">\(y(t)\)</span>.
If the answer is <em>a lot</em>, then the amplitude of the respective sinosoid should be large.
Therefore, computing <em>sinusoidals</em> that are similar to <span class="math notranslate nohighlight">\(y(t)\)</span> seems to be a good starting point.
Instead of similarity one speaks of <em>cross-correlation</em> which is a measure of similarity of two series as a function of the displacement of one relative to the other, also known as <em>sliding dot product</em> or <em>sliding inner-product</em>.</p>
<p>Functions are similar if their product result in a positive function.
In other words, if the integral of their product is positive.</p>
<p>In the following plot we can see this intuition at play.
The integral of <span class="math notranslate nohighlight">\(\sin(2\pi t)^2\)</span> gives us <span class="math notranslate nohighlight">\(0.5\)</span>, i.e., there is alot of <span class="math notranslate nohighlight">\(\sin(2\pi t)\)</span> in <span class="math notranslate nohighlight">\(\sin(2\pi t)\)</span>.
We also get a positive value for the integral of <span class="math notranslate nohighlight">\(\sin(2\pi t)\)</span> multiplied with the <a class="reference internal" href="../additive-synthesis/1-waveforms.html#sec-sawtooth-wave"><span class="std std-ref">sawtooth wave</span></a>.
The integrals of the other products are zero.</p>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">(</span> <span class="c1">// generate the y(t) * sin(2*pi*u)</span>
<span class="p">{[</span>
    <span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> 
    <span class="nb">LFSaw</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="nx">pi</span><span class="p">),</span>
    <span class="nb">LFTri</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">]}.</span><span class="nx">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
<p>Let’s have a look at the sum of the first terms of the <a class="reference internal" href="../additive-synthesis/1-waveforms.html#sec-sawtooth-wave"><span class="std std-ref">sawtooth wave</span></a>:</p>
<div class="math notranslate nohighlight">
\[y(t) = \sum_{k=1}^8 \frac{1}{k}\sin(2\pi \cdot k \cdot t).\]</div>
<p>For shorthand let us also define the product with a sine wave of a certain frequency of <span class="math notranslate nohighlight">\(n \in \mathbb{N}\)</span> Hz:</p>
<div class="math notranslate nohighlight">
\[g_n(t) = y(t) \cdot \sin(2\pi \cdot n \cdot t).\]</div>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">({</span>
    <span class="kd">var</span> <span class="nx">sines</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">{</span><span class="kd">arg</span> <span class="nx">i</span><span class="p">;</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);});</span>
    <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nb">Mix</span><span class="p">(</span><span class="nx">sines</span><span class="p">);</span>
    <span class="p">[</span><span class="nx">y</span><span class="p">]</span><span class="o">++</span><span class="nb">Array</span><span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">{</span><span class="kd">arg</span> <span class="nx">i</span><span class="p">;</span> <span class="nx">y</span><span class="o">*</span><span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)});</span>
<span class="p">}.</span><span class="nx">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
<p>We get</p>
<div class="math notranslate nohighlight">
\[\int_0^1 g_1(t)dt = \frac{1}{2}, \int_0^1 g_2(t)dt = \frac{1}{4}, \int_0^1 g_3(t)dt = \frac{1}{6}, \int_0^1 g_4(t)dt = \frac{1}{8}, \ldots\]</div>
<p>In general we get</p>
<div class="math notranslate nohighlight">
\[    \int_0^1 g_n(t)dt = \frac{1}{2n}.\]</div>
<p>Note that <span class="math notranslate nohighlight">\(\forall n \in \mathbb{N}:\)</span></p>
<div class="math notranslate nohighlight">
\[\int_0^1 \sin(2\pi \cdot n \cdot t)^2 dt = \frac{1}{2}\]</div>
<p>holds, thus</p>
<div class="math notranslate nohighlight">
\[\int_0^1 \frac{1}{n}\sin(2\pi \cdot n \cdot t)^2 dt = \frac{1}{n} \int_0^1 \sin(2\pi \cdot n \cdot t)^2 dt = \frac{1}{2n}.\]</div>
<p>Therefore,</p>
<div class="math notranslate nohighlight">
\[\int_0^1 g_n(t) dt = \frac{1}{n}\int_0^1 \sin(2\pi \cdot n \cdot t)^2 dt\]</div>
<p>follows.
If we look at the integral of</p>
<div class="math notranslate nohighlight">
\[h_n(t) = \left( y(t) - \frac{1}{n}\sin(2\pi \cdot n \cdot t) \right) \cdot \sin(2\pi \cdot n \cdot t),\]</div>
<p>then <span class="math notranslate nohighlight">\(\forall n \in \mathbb{N}:\)</span></p>
<div class="math notranslate nohighlight">
\[\int_0^1 h_n(t) dt = \int_{-\infty}^\infty h_n(t) dt = 0\]</div>
<p>holds.
In fact, if we look at <span class="math notranslate nohighlight">\(h_{i,j}(t) = \sin(2\pi i \cdot t ) \cdot \sin(2\pi j \cdot t)\)</span></p>
<div class="math notranslate nohighlight" id="equation-eq-perp-sines">
<span class="eqno">(25)<a class="headerlink" href="#equation-eq-perp-sines" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{split}
\forall i, j \in \mathbb{N}, i \neq j: \int_0^1 h_{i,j}(t) dt &amp;= \int_{0}^1 h_{i,j}(t) dt = 0\\
&amp;= \int_{-\infty}^\infty \sin(2\pi i \cdot t) \cdot \sin(2\pi j \cdot t ) dt\\
&amp;= \int_{-\infty}^\infty h_{i,j}(t) dt
\end{split}\end{split}\]</div>
<p>holds.</p>
<div class="theorem admonition" id="theorem-perp-sine">
<p class="admonition-title">Perpendicular Functions</p>
<p>For all frequencies <span class="math notranslate nohighlight">\(i, j \in \mathbb{N}\)</span> with <span class="math notranslate nohighlight">\(i \neq j\)</span></p>
<div class="math notranslate nohighlight">
\[\int_0^1 \sin(2\pi i \cdot t) \cdot \sin(2\pi j \cdot t ) dt = \int_{-\infty}^\infty \sin(2\pi i \cdot t) \cdot \sin(2\pi j \cdot t ) dt= 0\]</div>
<p>holds. We say that <span class="math notranslate nohighlight">\(\sin(2\pi i \cdot t)\)</span> is <em>perpendicular</em> to <span class="math notranslate nohighlight">\(\sin(2\pi j \cdot t)\)</span>.</p>
</div>
<div class="highlight-isc notranslate"><div class="highlight"><pre><span></span><span class="p">({</span> <span class="c1">// generate sin(2*pi*i*x) * sin(2*pi*j*x)</span>
    <span class="kd">var</span> <span class="nx">sines</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">{</span><span class="kd">arg</span> <span class="nx">i</span><span class="p">;</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">);});</span>
    <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nb">Mix</span><span class="p">(</span><span class="nx">sines</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">indices</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">fill2D</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">{</span><span class="kd">arg</span> <span class="nx">row</span><span class="p">,</span> <span class="nx">col</span><span class="p">;</span> <span class="p">[</span><span class="nx">row</span><span class="p">,</span><span class="nx">col</span><span class="p">];}).</span><span class="nx">flatten</span><span class="p">;</span>
    <span class="nx">indices</span><span class="p">.</span><span class="nx">collect</span><span class="p">({</span><span class="kd">arg</span> <span class="nx">index</span><span class="p">;</span> <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">j</span> <span class="o">=</span> <span class="nx">index</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">SinOsc</span><span class="p">.</span><span class="kd">ar</span><span class="p">(</span><span class="nx">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">});</span>
<span class="p">}.</span><span class="nx">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
<p>We say that these functions are <strong>perpendicular</strong> to each other because their scalar product (the integral of their product) is zero!</p>
<p>The similarity measure of two functions is similar to the similarity of two vectors.
One way to compare two vectors <span class="math notranslate nohighlight">\(\mathbf{a} = (a_1, \ldots, a_n)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b} = (b_1, \ldots, b_n)\)</span> is to compute their <em>inner product</em>.
If two vectors <span class="math notranslate nohighlight">\(\mathbf{a}, \mathbf{b}\)</span> are perpendicular, i.e., if they are very different, their <em>inner product</em></p>
<div class="math notranslate nohighlight">
\[&lt;\mathbf{a}, \mathbf{b}&gt; := \sum\limits_{i=1}^n a_i \cdot b_i\]</div>
<p>is zero.
Their inner product is large if they are similar.
We can define the inner product of two functions <span class="math notranslate nohighlight">\(h: \mathbb{R} \rightarrow \mathbb{R}\)</span> and <span class="math notranslate nohighlight">\(g: \mathbb{R} \rightarrow \mathbb{R}\)</span> in a similar fashion.
The sum changes to an integral.</p>
<div class="definition admonition" id="def-scalar-product">
<p class="admonition-title">Inner Product of two Functions</p>
<p>Let <span class="math notranslate nohighlight">\(h: \mathbb{R} \rightarrow \mathbb{R}\)</span> and <span class="math notranslate nohighlight">\(g: \mathbb{R} \rightarrow \mathbb{R}\)</span> then</p>
<div class="math notranslate nohighlight" id="equation-eq-inner-product">
<span class="eqno">(26)<a class="headerlink" href="#equation-eq-inner-product" title="Permalink to this equation">¶</a></span>\[    &lt;h,g&gt; := \int_{t \in \mathbb{R}} h(t)g(t) dt\]</div>
<p>is the inner product of <span class="math notranslate nohighlight">\(h\)</span> and <span class="math notranslate nohighlight">\(g\)</span>.
It is a measure of the similarity of <span class="math notranslate nohighlight">\(h\)</span> and <span class="math notranslate nohighlight">\(g\)</span>.</p>
</div>
</div>
<div class="section" id="fourier-synthesis">
<h2>Fourier Synthesis<a class="headerlink" href="#fourier-synthesis" title="Permalink to this headline">¶</a></h2>
<p>But let us start from the beginning, i.e., from the <em>Fourier series</em>.
The process of constructing a periodic function by a <em>Foruier series</em> is called <em>Fourier synthesis</em>.</p>
<div class="definition admonition" id="def-fourier-series">
<p class="admonition-title">Fourier Series (FS)</p>
<p>A <em>Fourier series</em> is a sum that represents a <em>periodic function</em> as a sum of <em>sine</em> and <em>cosine</em> waves.
The frequency of each wave in the sum is an integer multiple of the periodic function’s fundamental frequency.
The <em>Foruier series</em> in amplitude-phase form <span class="math notranslate nohighlight">\(y_N(t)\)</span> of a periodic function <span class="math notranslate nohighlight">\(y(t)\)</span> is defined by</p>
<div class="math notranslate nohighlight" id="equation-eq-fourier-series">
<span class="eqno">(27)<a class="headerlink" href="#equation-eq-fourier-series" title="Permalink to this equation">¶</a></span>\[y_N(t) = \frac{A_0}{2} + \sum\limits_{n=1}^N A_n \cdot \cos\left(\frac{2\pi \cdot n}{T}t - \phi_n\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is potentially an infinite integer.
<span class="math notranslate nohighlight">\(T = \frac{1}{f_0}\)</span> is the period of <span class="math notranslate nohighlight">\(y(t)\)</span>, <span class="math notranslate nohighlight">\(A_n\)</span> is the <span class="math notranslate nohighlight">\(n\)</span>-th hermonic’s <em>amplitude</em> and <span class="math notranslate nohighlight">\(\phi_n\)</span> is its <em>phase (shift)</em>.
<span class="math notranslate nohighlight">\(A_0/2\)</span> is the DC component, it is the mean value of <span class="math notranslate nohighlight">\(y(t)\)</span>.
<span class="math notranslate nohighlight">\(f_0\)</span> is the <em>fundamental frequency</em> of the signal.</p>
</div>
<p>Except for pathological functions, any periodic function can be represented by a <em>Fourier series (FS)</em> that converges.
Convergence of <em>Fourier series</em> means that as more and more harmonics from the series are summed, each successive partial <em>Fourier series sum</em> will better approximate the function, and will equal the function with a potentially infinite number of harmonics.</p>
<div class="theorem admonition" id="theorem-fourier-synthesis">
<p class="admonition-title">Fourier Theorem</p>
<p>Except for pathological functions, any periodic vibration, no matter how complicated it seems, can be built up from sinusoids whose frequencies are integer multiples of a fundamental frequency, by choosing the proper amplitudes and phases.</p>
</div>
<p>Non-periodic functions can be handled using an extension of the <em>Fourier series</em> called the <em>Fourier transform</em> which treats non-periodic functions as periodic with infinite period.
This transform thus can generate frequency domain representations of non-periodic functions as well as periodic functions, allowing a waveform to be converted between its time domain representation and its frequency domain representation.</p>
<p>In section <a class="reference internal" href="../additive-synthesis/additive-synthesis.html#sec-additive-synthesis"><span class="std std-ref">Additive Synthesis</span></a> we use <em>Fourier synthesis</em> to construct complicated waveforms from a sum of simple sinusoids, i.e., a <em>Fourier series</em>.
For example, the (periodic) <a class="reference internal" href="../additive-synthesis/1-waveforms.html#sec-sawtooth-wave"><span class="std std-ref">sawtooth wave</span></a></p>
<div class="math notranslate nohighlight">
\[    y_\text{saw}(t) = A \cdot 2 \left( f \cdot t -  \left \lfloor{ \frac{1}{2} + f \cdot t} \right \rfloor  \right),\]</div>
<p>can be constructed by an infinite sum</p>
<div class="math notranslate nohighlight">
\[    y_\text{saw}(t) = A \left( \frac{1}{2} - \frac{1}{\pi} \sum_{k=1}^{\infty} (-1)^k \frac{\sin(2\pi k f t)}{k} \right).\]</div>
</div>
<div class="section" id="fourier-analysis">
<h2>Fourier Analysis<a class="headerlink" href="#fourier-analysis" title="Permalink to this headline">¶</a></h2>
<p>Until know we assumed that all <em>phase shifts</em> are zero.
Then we concluded that if we compute the integral of signal <span class="math notranslate nohighlight">\(y(t)\)</span> multiplied with a sinusoid of the same phase we get:</p>
<ol class="simple">
<li><p>either <span class="math notranslate nohighlight">\(1/(2n)\)</span>, where <span class="math notranslate nohighlight">\(n \in \mathbb{N}\)</span> is the <strong>frequency</strong> of the sinusoid (similarity)</p></li>
<li><p>or zero, in this case <span class="math notranslate nohighlight">\(y(t)\)</span> is perpendicular to the sinusoid (non-similarity)</p></li>
</ol>
<p>We can reformulate the problem of similarity using an optimization problem.
Let us start with an analog signal first <span class="math notranslate nohighlight">\(y(t)\)</span>.
And let us reconsider the <em><a class="reference internal" href="#def-fourier-series"><span class="std std-ref">Fourier series</span></a></em>:</p>
<div class="math notranslate nohighlight">
\[y_N(t) = \frac{A_0}{2} + \sum\limits_{n=1}^N A_n \cdot \cos\left(\frac{2\pi \cdot n}{T}t - \phi_n\right)\]</div>
<p>We multiply some term of the sum of <span class="math notranslate nohighlight">\(y_N(t)\)</span> with our signal <span class="math notranslate nohighlight">\(y(t)\)</span> and integrate it over the period of our signal, to compute the measure of similarity:</p>
<div class="math notranslate nohighlight">
\[X_n(\phi) = \frac{2}{T}\int_T y(t) \cdot \cos\left(\frac{2\pi \cdot n}{T}t - \phi_n\right) dt, \quad \phi \in [0;2\pi].\]</div>
<p>Following our discussion at the start of section <a class="reference internal" href="#sec-similarity-of-functions"><span class="std std-ref">Similarity of Periodic Functions</span></a>, at the maximum of <span class="math notranslate nohighlight">\(X_n(\phi)\)</span> the integral is equal to the <strong>amplitude</strong> <span class="math notranslate nohighlight">\(A_n \cdot \frac{T}{2}\)</span>.
If the respective sinusoid is part of the <em>Fourier series</em></p>
<div class="math notranslate nohighlight">
\[A_n = \max\limits_{\phi \in [0;T]} X_n(\phi)\]</div>
<p>is not zero, otherwise it is.
Therefore, we multiply the integral by <span class="math notranslate nohighlight">\(\frac{2}{T}\)</span> to get <span class="math notranslate nohighlight">\(A_n\)</span>.
Furthermore, we get the missing <strong>phase shift</strong> defined by</p>
<div class="math notranslate nohighlight">
\[\phi_n = \arg\max\limits_{\phi \in [0;T]} X_n(\phi)\]</div>
<p>Using the equivalence of polar and Cartesian forms, that is,</p>
<div class="math notranslate nohighlight">
\[\cos\left(\frac{2\pi \cdot n}{T}t - \phi_n\right) \equiv \cos(\phi_n) \cdot \cos\left(\frac{2\pi \cdot n}{T}t \right) + \sin(\phi_n) \cdot \sin\left(\frac{2\pi \cdot n}{T}t \right)\]</div>
<p>We can simplify <span class="math notranslate nohighlight">\(X_n(\phi)\)</span>:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\begin{split}
X_n(\phi) &amp;= \frac{2}{T}\int_T y(t) \cdot \cos\left(\frac{2\pi \cdot n}{T}t - \phi_n\right) dt\\
&amp;= \cos(\phi) \cdot \underbrace{\frac{2}{T}\int_T y(t) \cdot \cos\left(\frac{2\pi \cdot n}{T}t \right)dt}_{a_n} + \sin(\phi) \cdot \underbrace{\frac{2}{T}\int_T y(t) \cdot \sin\left(\frac{2\pi \cdot n}{T}t \right)dt}_{b_n}\\
&amp;= \cos(\phi) \cdot a_n + \sin(\phi) \cdot b_n
\end{split}
\end{equation*}\]</div>
<p>The derivative of <span class="math notranslate nohighlight">\(X_n(\phi)\)</span> is zero at the <strong>phase</strong> of maximum correlation.
Threfore,</p>
<div class="math notranslate nohighlight">
\[X'_n(\phi_n) = \sin(\phi_n) \cdot a_n - \cos(\phi_n) b_n = 0 \Rightarrow \tan(\phi_n) = \frac{b_n}{a_n}\]</div>
<p>holds and the correlation peak value is:</p>
<div class="math notranslate nohighlight">
\[A_n = X_n(\phi_n) = \cos(\phi_n) a_n + \sin(\phi_n) b_n = \sqrt{a_n^2 + b_n^2}.\]</div>
<p>In other words, <span class="math notranslate nohighlight">\(a_n\)</span> and <span class="math notranslate nohighlight">\(b_n\)</span> are the <em>Cartesian coordinates</em> of a vector with <em>polar coordinates</em> <span class="math notranslate nohighlight">\(A_n\)</span> and <span class="math notranslate nohighlight">\(\phi_n\)</span>.
That is quite remarkable.
Furthermore, we can write the Fourier series replacing Eq. <a class="reference internal" href="#equation-eq-fourier-series">(27)</a> using <span class="math notranslate nohighlight">\(a_n\)</span> and <span class="math notranslate nohighlight">\(b_n\)</span> instead of <span class="math notranslate nohighlight">\(A_n\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-fourier-series-alternative">
<span class="eqno">(28)<a class="headerlink" href="#equation-eq-fourier-series-alternative" title="Permalink to this equation">¶</a></span>\[y_N(t) = \frac{a_0}{2} + \sum\limits_{n=1}^N \left[ a_n \cos\left( \frac{2\pi \cdot n}{T}t \right) + b_n \sin\left( \frac{2\pi \cdot n}{T}t \right) \right]\]</div>
<p>where <span class="math notranslate nohighlight">\(a_0 = A_0\)</span>. In this formula, the phase <span class="math notranslate nohighlight">\(\phi\)</span> is encoded in the interplay between sine and cosine.</p>
<p>Recalling <a class="reference internal" href="complex.html#sec-complex-numbers"><span class="std std-ref">complex numbers</span></a>, remember that</p>
<div class="math notranslate nohighlight">
\[\cos(\alpha) = \frac{e^{i\alpha} + e^{-i\alpha}}{2}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\sin(\alpha) = \frac{e^{i\alpha} - e^{-i\alpha}}{2i}\]</div>
<p>holds.
Therefore, we can write the Fourier series of a function in <em>complex form</em> by adapting Eq. <a class="reference internal" href="#equation-eq-fourier-series-alternative">(28)</a>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
y_N(t) &amp;= \frac{a_0}{2} + \sum\limits_{n=1}^N \left[ a_n \cos\left( \frac{2\pi \cdot n}{T}t \right) + b_n \sin\left( \frac{2\pi \cdot n}{T}t \right) \right]\\
&amp;= \frac{a_0}{2} + \sum\limits_{n=1}^N \left[ a_n \frac{e^{i 2\pi n t / T} + e^{-i 2\pi n t / T}}{2} + b_n \frac{e^{i 2\pi n t / T} - e^{-i 2\pi n t / T}}{2i} \right]\\
&amp;= \frac{a_0}{2} + \sum\limits_{n=1}^N \frac{a_n - ib_n}{2} e^{i 2\pi n t / T} + \sum\limits_{n=1}^N \frac{a_n + ib_n}{2} e^{-i 2\pi n t / T}\\
&amp;= \sum\limits_{n=-N}^N c_n e^{i2\pi n t / T}
\end{split}\]</div>
<p>Here we have used the following notations:</p>
<div class="math notranslate nohighlight">
\[c_0 = \frac{a_0}{2}, c_n = \frac{a_n - ib_n}{2}, c_{-n} = \frac{a_n + ib_n}{2}.\]</div>
<p>We finally arrive at the <em>Fourier series in its exponential form</em>.</p>
<div class="definition admonition" id="def-fourier-series-exp">
<p class="admonition-title">Fourier Series (FS) in its Exponential Form</p>
<p>The <em>Foruier series</em> in <em>exponential form</em> <span class="math notranslate nohighlight">\(y_N: \mathbb{R} \rightarrow \mathbb{C}\)</span> of a periodic function <span class="math notranslate nohighlight">\(y: \mathbb{R} \rightarrow \mathbb{C}\)</span> is defined by</p>
<div class="math notranslate nohighlight">
\[y_N(t) = \sum\limits_{n = -N}^N c_n \cdot e^{i2\pi n t / T}\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is potentially an infinite integer.
<span class="math notranslate nohighlight">\(T\)</span> is the period of <span class="math notranslate nohighlight">\(y(t)\)</span>, <span class="math notranslate nohighlight">\(A_n\)</span> is the <span class="math notranslate nohighlight">\(n\)</span>-th hermonic’s <em>amplitude</em>
<span class="math notranslate nohighlight">\(c_n\)</span> is defined by</p>
<div class="math notranslate nohighlight">
\[\begin{split}
c_n = \frac{1}{T} \int_T y(t) \cdot e^{-i2\pi n t / T}dt = \begin{cases} 
A_0/2 &amp;= a_0 / 2 &amp; \text{ if } n = 0\\
\frac{A_n}{2}e^{-i \phi_n} &amp;= \frac{1}{2} (a_n - i b_n), &amp; \text{ if } n &gt; 0\\
\overline{c}_{|n|}, &amp; &amp; \text{ if } n &lt; 0
\end{cases}
\end{split}\]</div>
<p>This form generalizes to <strong>complex-valued functions</strong>.</p>
</div>
<p>In this form <strong>phase</strong> and <strong>amplitude</strong> are represented by a phasor, e.g., <span class="math notranslate nohighlight">\(A_n / 2 e^{-i \phi_n}\)</span>.</p>
<p>We can define <span class="math notranslate nohighlight">\(Y_N : \mathbb{Z} \rightarrow \mathbb{C}\)</span></p>
<div class="amsmath math notranslate nohighlight" id="equation-3aac57bc-340f-487c-8b78-9d5290026826">
<span class="eqno">(29)<a class="headerlink" href="#equation-3aac57bc-340f-487c-8b78-9d5290026826" title="Permalink to this equation">¶</a></span>\[\begin{equation}
Y_N(n) = c_n,
\end{equation}\]</div>
<p>to be the <a class="reference internal" href="complex.html#def-phasor"><span class="std std-ref">phasor</span></a> of the respective sinusoid with <strong>frequency</strong> <span class="math notranslate nohighlight">\(n\)</span> times the fundamental frequency <span class="math notranslate nohighlight">\(f_0\)</span> of the <em>Fourier series</em> of a (real) <strong>periodic function</strong> <span class="math notranslate nohighlight">\(y(t)\)</span> with period equal to <span class="math notranslate nohighlight">\(1/f_0\)</span>.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/sounddesign/math"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="complex.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Complex Numbers</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="fourier-transform.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fourier Transform</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Benedikt Zönnchen<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>